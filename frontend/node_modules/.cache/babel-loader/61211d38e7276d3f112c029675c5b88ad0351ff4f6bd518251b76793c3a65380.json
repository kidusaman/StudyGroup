{"ast":null,"code":"var _jsxFileName = \"/Users/kidusamanuel/Desktop/school project/frontend/src/GroupChat.js\",\n  _s = $RefreshSig$();\n// src/GroupChat.js\nimport React, { useEffect, useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport axios from 'axios';\nimport { Container, Row, Col, Form, Button } from 'react-bootstrap';\nimport { groupMessagesByDate } from './utils/groupMessagesByDate'; // grouping function\nimport { format } from 'date-fns';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction GroupChat({\n  user,\n  token,\n  socket\n}) {\n  _s();\n  const {\n    groupId\n  } = useParams();\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  useEffect(() => {\n    // Join the group room\n    socket.emit(\"joinGroup\", groupId);\n\n    // Fetch existing messages\n    axios.get(`http://localhost:5001/api/group-chat/${groupId}`, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    }).then(res => setMessages(res.data)).catch(err => console.error(\"Error fetching group messages:\", err));\n\n    // Listen for new messages\n    const handleGroupMessage = msgData => {\n      if (parseInt(msgData.group_id) === parseInt(groupId)) {\n        setMessages(prev => [...prev, msgData]);\n      }\n    };\n    socket.on(\"receiveGroupMessage\", handleGroupMessage);\n\n    // Cleanup on unmount\n    return () => {\n      socket.off(\"receiveGroupMessage\", handleGroupMessage);\n    };\n  }, [groupId, token, socket]);\n  const handleSendMessage = e => {\n    e.preventDefault();\n    if (!newMessage.trim()) return;\n\n    // Send to server\n    socket.emit(\"sendGroupMessage\", {\n      groupId: parseInt(groupId),\n      userId: user.id,\n      message: newMessage.trim()\n    });\n\n    // Optimistic UI\n    setMessages(prev => [...prev, {\n      group_id: groupId,\n      user_id: user.id,\n      message: newMessage.trim(),\n      created_at: new Date().toISOString(),\n      username: user.username\n    }]);\n    setNewMessage('');\n  };\n\n  // Group messages by date for a cleaner look\n  const grouped = groupMessagesByDate(messages);\n  return /*#__PURE__*/_jsxDEV(Container, {\n    fluid: \"md\",\n    className: \"mt-4\",\n    children: /*#__PURE__*/_jsxDEV(Row, {\n      children: /*#__PURE__*/_jsxDEV(Col, {\n        xs: 12,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-center mb-4\",\n          children: [\"Group Chat - Group \", groupId]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            border: '1px solid #ccc',\n            height: '400px',\n            overflowY: 'auto',\n            marginBottom: '1rem',\n            padding: '1rem',\n            background: '#fff'\n          },\n          children: grouped.map((group, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center text-muted mb-2\",\n              style: {\n                fontWeight: 'bold'\n              },\n              children: group.date\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 87,\n              columnNumber: 17\n            }, this), group.messages.map((msg, mIdx) => /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                margin: '10px 0',\n                padding: '8px',\n                borderRadius: '5px',\n                backgroundColor: msg.user_id === user.id ? '#e0ffe0' : '#f0f0f0'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: msg.username\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 100,\n                columnNumber: 21\n              }, this), \": \", msg.message, /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontSize: '0.8em',\n                  color: '#555'\n                },\n                children: format(new Date(msg.created_at), 'hh:mm a')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 101,\n                columnNumber: 21\n              }, this)]\n            }, mIdx, true, {\n              fileName: _jsxFileName,\n              lineNumber: 91,\n              columnNumber: 19\n            }, this))]\n          }, idx, true, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Form, {\n          onSubmit: handleSendMessage,\n          children: /*#__PURE__*/_jsxDEV(Row, {\n            children: [/*#__PURE__*/_jsxDEV(Col, {\n              xs: 9,\n              children: /*#__PURE__*/_jsxDEV(Form.Control, {\n                type: \"text\",\n                placeholder: \"Type your message...\",\n                value: newMessage,\n                onChange: e => setNewMessage(e.target.value)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 114,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 113,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              xs: 3,\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                type: \"submit\",\n                variant: \"primary\",\n                className: \"w-100\",\n                children: \"Send\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 122,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 121,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 5\n  }, this);\n}\n_s(GroupChat, \"gYDjSDIFU5Jjspr0XiQwxk7m41k=\", false, function () {\n  return [useParams];\n});\n_c = GroupChat;\nexport default GroupChat;\nvar _c;\n$RefreshReg$(_c, \"GroupChat\");","map":{"version":3,"names":["React","useEffect","useState","useParams","axios","Container","Row","Col","Form","Button","groupMessagesByDate","format","jsxDEV","_jsxDEV","GroupChat","user","token","socket","_s","groupId","messages","setMessages","newMessage","setNewMessage","emit","get","headers","Authorization","then","res","data","catch","err","console","error","handleGroupMessage","msgData","parseInt","group_id","prev","on","off","handleSendMessage","e","preventDefault","trim","userId","id","message","user_id","created_at","Date","toISOString","username","grouped","fluid","className","children","xs","fileName","_jsxFileName","lineNumber","columnNumber","style","border","height","overflowY","marginBottom","padding","background","map","group","idx","fontWeight","date","msg","mIdx","margin","borderRadius","backgroundColor","fontSize","color","onSubmit","Control","type","placeholder","value","onChange","target","variant","_c","$RefreshReg$"],"sources":["/Users/kidusamanuel/Desktop/school project/frontend/src/GroupChat.js"],"sourcesContent":["// src/GroupChat.js\nimport React, { useEffect, useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport axios from 'axios';\nimport { Container, Row, Col, Form, Button } from 'react-bootstrap';\nimport { groupMessagesByDate } from './utils/groupMessagesByDate'; // grouping function\nimport { format } from 'date-fns';\n\nfunction GroupChat({ user, token, socket }) {\n  const { groupId } = useParams();\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n\n  useEffect(() => {\n    // Join the group room\n    socket.emit(\"joinGroup\", groupId);\n\n    // Fetch existing messages\n    axios.get(`http://localhost:5001/api/group-chat/${groupId}`, {\n      headers: { Authorization: `Bearer ${token}` }\n    })\n    .then((res) => setMessages(res.data))\n    .catch((err) => console.error(\"Error fetching group messages:\", err));\n\n    // Listen for new messages\n    const handleGroupMessage = (msgData) => {\n      if (parseInt(msgData.group_id) === parseInt(groupId)) {\n        setMessages((prev) => [...prev, msgData]);\n      }\n    };\n    socket.on(\"receiveGroupMessage\", handleGroupMessage);\n\n    // Cleanup on unmount\n    return () => {\n      socket.off(\"receiveGroupMessage\", handleGroupMessage);\n    };\n  }, [groupId, token, socket]);\n\n  const handleSendMessage = (e) => {\n    e.preventDefault();\n    if (!newMessage.trim()) return;\n\n    // Send to server\n    socket.emit(\"sendGroupMessage\", {\n      groupId: parseInt(groupId),\n      userId: user.id,\n      message: newMessage.trim()\n    });\n\n    // Optimistic UI\n    setMessages((prev) => [\n      ...prev,\n      {\n        group_id: groupId,\n        user_id: user.id,\n        message: newMessage.trim(),\n        created_at: new Date().toISOString(),\n        username: user.username\n      }\n    ]);\n    setNewMessage('');\n  };\n\n  // Group messages by date for a cleaner look\n  const grouped = groupMessagesByDate(messages);\n\n  return (\n    <Container fluid=\"md\" className=\"mt-4\">\n      <Row>\n        <Col xs={12}>\n          <h2 className=\"text-center mb-4\">Group Chat - Group {groupId}</h2>\n\n          {/* Chat Messages Area */}\n          <div\n            style={{\n              border: '1px solid #ccc',\n              height: '400px',\n              overflowY: 'auto',\n              marginBottom: '1rem',\n              padding: '1rem',\n              background: '#fff'\n            }}\n          >\n            {grouped.map((group, idx) => (\n              <div key={idx}>\n                {/* Date heading */}\n                <div className=\"text-center text-muted mb-2\" style={{ fontWeight: 'bold' }}>\n                  {group.date}\n                </div>\n                {group.messages.map((msg, mIdx) => (\n                  <div\n                    key={mIdx}\n                    style={{\n                      margin: '10px 0',\n                      padding: '8px',\n                      borderRadius: '5px',\n                      backgroundColor: msg.user_id === user.id ? '#e0ffe0' : '#f0f0f0'\n                    }}\n                  >\n                    <strong>{msg.username}</strong>: {msg.message}\n                    <div style={{ fontSize: '0.8em', color: '#555' }}>\n                      {format(new Date(msg.created_at), 'hh:mm a')}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            ))}\n          </div>\n\n          {/* Send Message Form */}\n          <Form onSubmit={handleSendMessage}>\n            <Row>\n              <Col xs={9}>\n                <Form.Control\n                  type=\"text\"\n                  placeholder=\"Type your message...\"\n                  value={newMessage}\n                  onChange={(e) => setNewMessage(e.target.value)}\n                />\n              </Col>\n              <Col xs={3}>\n                <Button type=\"submit\" variant=\"primary\" className=\"w-100\">\n                  Send\n                </Button>\n              </Col>\n            </Row>\n          </Form>\n        </Col>\n      </Row>\n    </Container>\n  );\n}\n\nexport default GroupChat;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}